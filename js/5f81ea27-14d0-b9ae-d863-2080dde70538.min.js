/* Minifyed by 13ninstudio, Inc */ const workerBlob=new Blob(['importScripts("https://cdn.jsdelivr.net/npm/lzma@2.3.2/src/lzma_worker-min.js");'],{type:"application/javascript"}),workerURL=URL.createObjectURL(workerBlob),lzma=new LZMA(workerURL);function uint8ToBase64(e){let t=0,n="";for(;t<e.length;)n+=String.fromCharCode.apply(null,e.subarray(t,t+32768)),t+=32768;return btoa(n)}function base64ToUint8(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}const inputText=document.getElementById("inputText"),btn7z=document.getElementById("btn7z"),btn7zDownload=document.getElementById("btn7zDownload"),outBase64=document.getElementById("outBase64"),inputSizeEl=document.getElementById("inputSize"),compressedSizeEl=document.getElementById("compressedSize"),levelSel=document.getElementById("level"),sevenFileInput=document.getElementById("sevenFile"),btnUn7zFile=document.getElementById("btnUn7zFile"),btnUn7zFileDownload=document.getElementById("btnUn7zFileDownload"),btnUn7zFromBase64=document.getElementById("btnUn7zFromBase64"),outText=document.getElementById("outText");function updateInputSize(){const e=(new TextEncoder).encode(inputText.value).length;inputSizeEl.textContent=e}function do7z(e,t=6){return new Promise(((n,o)=>{lzma.compress(e,Number(t),((e,t)=>{if(t)return console.error("do7zError:",t),void o(t);n(new Uint8Array(e))}))}))}updateInputSize(),inputText.addEventListener("input",updateInputSize),btn7z.addEventListener("click",(async()=>{try{const e=inputText.value,t=levelSel.value,n=await do7z(e,t);outBase64.value=uint8ToBase64(n),compressedSizeEl.textContent=n.length}catch(e){console.error(e)}})),btn7zDownload.addEventListener("click",(async()=>{try{const e=inputText.value,t=levelSel.value,n=await do7z(e,t),o=new Blob([n],{type:"application/x-lzma"}),a=URL.createObjectURL(o),r=document.createElement("a");r.href=a,r.download="data.lzma",r.click(),setTimeout((()=>URL.revokeObjectURL(a)),3e3)}catch(e){console.error(e)}}));let lastLoadedUint8=null;function extract7z(e){return new Promise(((t,n)=>{lzma.decompress(e,((e,o)=>{if(o)return console.error("extract7zError:",o),void n(o);t(e)}))}))}sevenFileInput.addEventListener("change",(async e=>{const t=e.target.files?.[0];t&&(lastLoadedUint8=new Uint8Array(await t.arrayBuffer()),alert("LZMA ファイルを読み込みました。"))})),btnUn7zFile.addEventListener("click",(async()=>{if(!lastLoadedUint8)return alert("まず LZMA ファイルを選択してください");outText.value=await extract7z(lastLoadedUint8)})),btnUn7zFileDownload.addEventListener("click",(async()=>{if(!lastLoadedUint8)return alert("まず LZMA ファイルを選択してください");const e=await extract7z(lastLoadedUint8),t=new Blob([e],{type:"text/plain; charset=utf-8"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="data.txt",o.click(),setTimeout((()=>URL.revokeObjectURL(n)),3e3)})),btnUn7zFromBase64.addEventListener("click",(async()=>{const e=outBase64.value.trim();if(!e)return alert("Base64 を入力してください");const t=base64ToUint8(e);outText.value=await extract7z(t)}));