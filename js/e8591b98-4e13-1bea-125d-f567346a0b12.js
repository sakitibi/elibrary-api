const keyMap = {
  "warning-list": "xtELN8QHdW",
  "1": "IZHu54v8NW",
  "friend-code": "JZPJRHToXs",
  "username": "1GsJC2ukBD",
  "2": "5KAr2wMlEt",
  "3": "sbwvMb9MND",
  "4": "3qChnU1VSY",
  "5": "GCNOfHTpjE",
  "network-id": "ZN21c9XMvh",
  "6": "salsJNq7qb",
  "7": "nuVbcWhXlQ",
  "8": "LNYLjXCQr1",
  "9": "EO9wJMrrEH",
  "10": "S6z3UFPg8v",
  "11": "5QXEWlv8rE",
  "12": "xD8almGNMV",
  "13": "e01yxmtj4O",
  "14": "9Rg7UPKHLx",
  "15": "WRsLWO0ehy",
  "16": "21TEh1aAUT",
  "email": "Gxgq0fCzbL",
  "17": "iyB0aR4yWB",
  "riyuu": "Ahq2ot4I8d",
  "danger-list": "gCwrf79C06",
  "browser-id": "zhyoDQtSMG",
  "18": "GWgVwLkj21",
  "19": "hMK3gtMgvy",
  "taisaku": "XqZBTStVHy",
  "20": "2t5XjCrnem",
  "21": "YazTiEUPz3",
  "22": "DUqJJ22did",
  "23": "CoFjkOh3Wx",
  "24": "NanAeMsXNb",
  "25": "pGuCxwe7q2",
  "ipaddress": "U48UfY2DnE",
  "company": "ptdfrp1Vtw",
  "cookie": "BLqDWQHmFZ",
  "Hostname": "eXmPiWCQf2",
  "UA": "48hnjqicA6",
  "26": "TzU3HSnaef",
  "super-danger-list": "t9jInZM8vS",
  "SMS-token": "5bPXPuHG35",
  "country": "j6Hj8rfV25",
  "region": "iT3NC59IVQ",
  "provider": "tdLLWQH02m",
  "amongus-username": "8kThwLCrYH",
  "youtube-name": "74WV5ssrfc",
  "blacklist": "dpV4UXfatf",
  "x-name": "aQsjwh03Zl",
  "hidden": "kgXd04P7u2",
  "birthday": "QmeqEId7Ms",
  "month": "Jz7R4pHSCQ",
  "date": "9czbg0itxi"
};

const valueMap = {
  "unknown": "3GlKLbjL0C",
  "あ": "cLQlqfX39A",
  "jetbass#5533": "X16SNTbZzR",
  "Poetsleek": "QIqYE2EqL0",
  "小学3年生": "jxYqjcOIDW",
  "ゴルシ": "dYZsOcTI3g",
  "onlypolka#2844": "PuhdHOobcn",
  "4OVclkhP": "6sVFluJ2ei",
  "A": "aI6EvLQb0w",
  "scarablate#5401": "toqhM2pxzB",
  "SUSHI": "dUJIr0xYNo",
  "chiefbaby#2393": "4QQIWd22dz",
  "3HjNoB9s": "2S95iLm4Bu",
  "雪大根": "3Y5qr7gC1J",
  "chewyhusky#4955": "kxFYZx13TH",
  "Reward": "HNtNHzqH0P",
  "looprimed#8348": "5zKgLFfS9T",
  "パンダ好き": "uS3x4tZnVf",
  "planktall#9413": "SmsJFoHqTD",
  "焼き鳥": "5jw8Xlacju",
  "oursilk#3577": "KhXcTRbBIM",
  "ボンド": "lbyLmRpbzT",
  "wingerleft#5358": "NV2kMeBKHT",
  "あもんぐたのしい": "Fn5Dpn1STY",
  "auntyherby#2848": "LNULSktRck",
  "しいたけ": "p0X5IbWBVp",
  "unusedoval#7025": "ORrTBNuQEj",
  "erawer@awera.com": "5xRlitwqXD",
  "a@awerawer.com": "OYxyI7QHoX",
  "awera@a.com": "K4AtekniHI",
  "mafu.mafu.roboro@gmail.com": "86O4TIX1zY",
  "riceball": "OHCKfSKdZq",
  "termsbaggy#3497": "v7Ex3fQlyC",
  "意味不明な事を言ったから": "LmVgDhcSZY",
  "rrI2L5t": "V9dTt7P1Zf",
  "Gwkt0106": "UKShRR0Bgz",
  "FaudalOwl336510": "LdredA7Sz5",
  "56EjqG1Y": "x9iMIcFqVV",
  "kPngazH": "3IIls1yPnW",
  "3kBfXl81": "TREHjWdMBO",
  "Nevvvd": "zeMXIoIGZ1",
  "ロードプリンス": "4bNqkaNx6T",
  "中身は初心者": "6XkSTtOfI9",
  "dapperfire#1991": "0RG4kdqckd",
  "まさかず": "0U8UjNaGC2",
  "firsingle#4189": "MSkHHm4gIO",
  "3": "r57LT0DPcx",
  "loggerfit#1912": "JvFFUMRSub",
  "、": "03sOcUVUQc",
  "voterocky#6996": "x3o6FmvO3z",
  "スカニア好き": "jeptX0VMba",
  "投票": "WYHvIk8m9h",
  "snacksworn#7311": "WSQBsWr8Vj",
  "人外の原石": "l1u2K5O475",
  "usedskill#4275": "JWxEGuuHQM",
  "U5UCSCt": "HyKbOnVVFZ",
  "4sVvHoqQ": "Iy9iweDOz0",
  "AFN運営委員会": "s2RsoyEbkY",
  "コメント荒らし": "pgfBdLXwv3",
  "ワッサンマッド許さん": "Y2d5IRFUvv",
  "arrowsnowy#7134": "g0sa4NOHdt",
  "名前は長い方が有利とグル": "xTfJwnfpt7",
  "とんかつ味のアソライ": "9ptNHgF6gJ",
  "ablazetofu#6484": "vntkZUnB6J",
  "名前はだいの方が有利": "s4f7lp0DAl",
  "がまねむ": "bcE2H7SR2u",
  "flitlanded#9228": "amHvqccwRp",
  "㍌村I鶏煎餅": "k2NQVa5ykr",
  "ミニトマト隊　隊長": "fZAC4GBCqx",
  "daichan": "etibNc3SF6",
  "只今規制中": "k6yu1wrIe9",
  "2t6Avku7": "Ar21BuPRil",
  "fOWimF8": "anH2cEL2wV",
  "匿名(偽物)": "oWdtvO0qsW",
  "なりすまし": "WbOz7qKY7n",
  "KIREねこ": "MJFLx8cHN5",
  "ラムネ様への誹謗中傷": "EBHW9cFbF1",
  "WhitePAWA": "vmzyoE4njh",
  "4qIzMvJU": "bUOWw2ovWW",
  "2Ei4IiSz": "lSEIOwm78v",
  "みぞれさんの活動の妨害": "VDF2a9g2d1",
  "1OXfPCcI": "tKIUzAwj7A",
  "cXdbMOx": "ylzt7DmAvO",
  "2OTsrFKq": "wWKrCFsbGZ",
  "4388UWFO": "UXBYcXpALe",
  "122.196.202.142": "yvOaHsmecY",
  "マグロのユッケ": "WJiYBX3mrw",
  "草原急行": "m0z1WtB2Fo",
  "d1537239810d8b39555cec623d559368c8070b17871": "324LBlG8V0",
  "zaq7ac4ca8e.rev.zaq.ne.jp": "tBGXC2A7zD",
  "Chrome Mobile WebView 136.0.7103/Android 14": "zRDJ4aMy74",
  "マイ鉄荒らし対策委員会に同一名があった為": "TAvnh329OK",
  "4J20db1l": "Gi3KwytNjM",
  "K9uigye": "gjvEGHLTwl",
  "BMR (Bedrock Minecraft Railway)": "jtv9l4jkAK",
  "理由：利用規約第20条要注意人物リスト及び指定団体リストに入らない事に違反した為また本人否定確信犯": "aKFbrygvm6",
  "vzblh0q": "NNRguqM2oe",
  "2EYHDDHF": "HNXq5XFkcp",
  "4yrbHtev": "4K9TccZ2Kc",
  "3n7qv8ra": "7GIjjaZ7Rr",
  "3gBOywbY": "DT0noAzgz9",
  "4BaNXiVu": "2r2VHjVubp",
  "2oOBjXLQ": "tZU4PsH0de",
  "4iJoKmwl": "J7IOoTTVt8",
  "熟成牛タン": "n5gNOBEg29",
  "秋月": "8IMkJS50G0",
  "高浜電気鉄道": "dVeCHY0cwH",
  "raWy4ml": "sOHuv15xFx",
  "2A1siZM3": "OY1C5cQSsS",
  "f735d3f4043164721acb6cd3eef197c4ac055dff8da": "mAwFowToaU",
  "softbank221044137228.bbtec.net": "MzTOkl9UoH",
  "221.44.137.228": "WG7WNFcaRP",
  "K-Generic_Android-K/Android-10/Chrome Mobile-132.0.0": "6lJh6HyAmz",
  "bddcde8c-9f87-4847-ad85-0161ed50c103": "j9f1zC1VlM",
  "1GLLCE0B": "rcGM9JaxTw",
  "HTbEfTI": "5rFOKUJtHq",
  "1tCyuB2U": "g6sEPz7VGc",
  "カワシマ": "aSTPAzILOT",
  "chunkyodds#3153": "NO2P7A2She",
  "20uRMcQt": "Ajc7iXkYUz",
  "4GY335U1": "UqzS2C4tTF",
  "138.201.224.59": "j0oR5jqPCG",
  "e10ca098423f1bfcfee380d36f6d82123a22828f038": "Ghi6rZLF4P",
  "static.59.224.201.138.clients.your-server.de": "1joi7DZ808",
  "Chrome 119.0.0/Windows 10": "cWF85CmkB9",
  "🇩🇪ドイツ": "NLR9B4fj1m",
  "ザクセン": "HkZj6RwxIx",
  "Hetzner Online GmbH": "XLIgxBbMEv",
  "名前は猫の方が有利": "7AeBv0jjEd",
  "fineown#3933": "KJIbDGQP63",
  "九尾": "DoJNYDK9D1",
  "blaseshape#4922": "P1F8cX1DXk",
  "ゆどうふ": "lvyw6Ewc6A",
  "多方面への悪口": "kufitOneAI",
  "牛3円偽": "hwFbrNxEcs",
  "匿名のDiscordでの荒らし": "mkEbK0UC2Z",
  "インポスター引きたい": "BrDKr9k4Cy",
  "likerain#0448": "vfzcnOPafS",
  "不明": "zpPF81IaFB",
  "kellelhome#1482": "4jViISffeC",
  "いちごミルクの素": "yLSbrF8hqP",
  "galajokey#3559": "OYfSv44WG0",
  "2TO9gM3a": "V24lfiNGSk",
  "3iQ21BGA": "AwLVSx1JJN",
  "153.242.253.143": "JKXZp9Rf1O",
  "36480e41595a33739e9e0e27d6b618ff4d3f91344bc": "eU0tI6TSk0",
  "p896144-ipoe.ipoe.ocn.ne.jp": "ADd12VVd2U",
  "Mobile Safari 15.6.6/iOS 15.8.3": "yRuNHGssai",
  "wikiページ荒らし": "1VLyVfK82Q",
  "しおん(紫音ちゃんじゃない方)": "9oxhYVZH2U",
  "unlinedyea#3406": "K9ZAuhXIeT",
  "lowergoody#2833": "TXCX3J1r77",
  "1p6LXgw3": "iSiPYqAUqd",
  "3cXGwELF": "S11wnAUlk5",
  "14.9.86.64": "RhQzJdjilz",
  "M014009086064.v4.enabler.ne.jp": "5M4lf9issM",
  "8f408a2cabb2c21ce69103d2df32153edbad2c070f3": "Zp4Lae00HT",
  "Chrome 137.0.0/Windows 10": "24SQPNDVnz",
  "2f044389-7cb8-414c-9fde-d141c9df70da": "KQPvywNFX5",
  "青森県八戸市": "8wca51xxzM",
  "日本ネットワークイネイブラー株式会社": "XqPf1hFr1v",
  "大規模なWikiページ荒らし": "zVEahTwyV8",
  "名前は長い方が有利": "IfYPG3zUSR",
  "ourluck#4319": "PNtakftowB",
  "名前は長い方が有利🐦": "Lgk1DTebbQ",
  "12ninstudio様&ラムネ様が部屋に入った際、あらぬ疑いをかけ部屋から追放した上に、視聴者が悪口を言い、雰囲気が良くないためまた、この雰囲気を改善しようとしない、複数人に対して冤罪をかけているが反省の色が見えない": "IpfEaCENBF",
  "全面戦争する": "onQ71ARHpn",
  "法的措置を取る": "DPWgLaE367",
  "カービィ大好き!": "M8QL5FVJrx",
  "過度な概要欄要求": "hdZoWmvZvf",
  "ウォーターチャレンジ": "0A4qY98VzP",
  "すまない先生": "wK15T7AAEV",
  "04": "RcNC87QboA",
  "21": "XX7RjYaaKk",
  "ミスター赤ちゃん": "HxRL9H1hsg",
  "ミスター銀さん": "mCrkJRhWoR",
  "ミスターバナナ": "k8JyVTnoE8",
  "ミスターマネー": "0XieFFwupw",
  "ミスターブルー": "zen8iREO1A",
  "ミスターレッド": "DeSpRxk18W",
  "ミスターブラック": "K4NJaRw5sJ",
  "3TpPOgru": "fTzcrMmPvu",
  "4ukSGQzf": "r2ZPdilP3l",
  "122.135.139.195": "E73iS3EDyq",
  "8e4dd215b144ad1083ef9cd95ebd7889b85d00298e9": "qwKkTId3vz",
  "FL1-122-135-139-195.hyg.mesh.ad.jp": "KSTsrFFIxH",
  "Opera 117.0.0/Windows 10": "uUYRcT0dg1",
  "153HUhxM": "i9l5shMBOG",
  "1grkU4Xh": "r6rD2Ig318",
  "14.9.13.224": "DreskcUFl9",
  "9ffdbf6d43b80e6d410970357f1aa255d7be9437d9d": "6CI8mmWymA",
  "M014009013224.v4.enabler.ne.jp": "59q1591KUK",
  "Chrome 134.0.0/Chrome OS 14541.0.0": "u9t5fHX8Fi",
  "3kcX4O48": "0U5bXTPDO5",
  "4gCaAGBy": "6aEjii1SiM",
  "60.94.79.163": "HUV0RZ1oQN",
  "d2ff5fe6ff226e63f277b056d4337dee1674b653953": "00jlRRRau8",
  "softbank060094079163.bbtec.net": "dm0KEJ56fb",
  "Mobile Safari 18.3.1/iOS 18.3.2": "hImEpq0Xaz",
  "2YUi8xLu": "EKfNaUpw0z",
  "GgiSWKH": "eMIKBNgZL6",
  "111.188.188.186": "e80opxesQM",
  "815c46f002f31c5b9fcd9fd6225acdcd63cd9ab2107": "WBq1JYgoSN",
  "softbank111188188186.bbtec.net": "3SUhsU7T3d",
  "LINE 15.2.1/Android 15": "XfTlQm8cuJ",
  "SkTMFGv": "IYHWTThZwI",
  "1tpzypoC": "nzAOG7C7Bo",
  "124.18.233.93": "d52iC6oP9C",
  "d92e5b49e5f3c8e414fcdad83158f0e35f773cfb864": "Jgc9kzTfSq",
  "124-18-233-93.area56a.commufa.jp": "YwecgQKT0Z",
  "Chrome 134.0.0/Windows 10": "Fm4U317TXh",
  "4W56iEyZ": "qhhXzew2SB",
  "2OYvXuyC": "07IfL0aysH",
  "118.7.71.129": "ubLTv70eXd",
  "caecc6e75af52f8fc61994edca8ea5356784958724f": "xq0O5mjOig",
  "p1738130-ipoe.ipoe.ocn.ne.jp": "pRECGVP3Vs",
  "LINE 15.2.3/iOS 18.3.1": "L7oKcrE4sB",
  "4QbUlJdQ": "2o2fLbQeCu",
  "4gqjJxEd": "kKYivNrDKE",
  "49.109.163.33": "EPVXFyZ3LY",
  "5493b91665d2f72289a4d2d0af144e266a43085b3dc": "kjjZ01rmtH",
  "sp49-109-163-33.tck02.spmode.ne.jp": "Ds2tfO09ND",
  "Chrome Mobile 134.0.0/Android 10": "bImSXDTB4W",
  "fa203b43952a869ceb953c7d4edcd833511b0bce91a": "K2RCW3HvOC",
  "Chrome 133.0.0/Chrome OS 14541.0.0": "TLT5KDh3XJ",
  "180.20.39.172": "63RSG7KMmf",
  "p13207172-ipxg46001marunouchi.tokyo.ocn.ne.jp": "50AE1jnPDi",
  "L2svhr7": "B8q7LFgchA",
  "143.189.209.108": "QVasktNcPB",
  "fs8fbdd16c.tkyc002.ap.nuro.jp": "BocTcKPjm8",
  "219.104.135.53": "bJZT32I0kb",
  "94830debb30941f4a1c3b58c249be0ddfd2a7671ed1": "tu62yqB3bJ",
  "madb688735.ap.nuro.jp": "MwHZfSBXMg",
  "Windows-10/Edge-135.0.0": "zoraZamaqN",
  "118.241.250.176": "gIV8TvLYom",
  "mp76f1fab0.ap.nuro.jp": "QRAfKqCbVk",
  "Windows-10 / Edge-135.0.0": "q8zskb4K2P",
  "211.132.93.141": "MZmmv0c0rG",
  "619e8fac852e3f78601af7a8eace0cf1ca33e569854": "K4HFnd8W68",
  "opt-211-132-93-141.client.pikara.ne.jp": "jBD0xXwNAB",
  "iPhone-Apple-iPhone / iOS-17.6.1 / Google-367.0.752095380": "WZPz7R4EGX",
  "D6zol7r": "KlIko9En7U",
  "4LrRpffy": "2FgmKR9VYi",
  "126.219.88.117": "dwiZUhUZte",
  "d28875fb5f0add7c5d9cf922d5d9d9bed12cfc5f333": "Z9A6exWL6w",
  "softbank126219088117.bbtec.net": "my8A0DIz18",
  "Safari 18.3/Mac OS X 10.15.7": "jiogCwrL9E",
  "118.9.16.2": "GDCk14XaoV",
  "ee6219bb1b6ddc1bb05763b766a376e9445de43aab7": "nMv8wdvmx0",
  "p2131003-ipoe.ipoe.ocn.ne.jp": "Cc8xvyWxSG",
  "Windows-10 / Firefox-139.0": "MracMymXny",
  "1PuQhzVN": "3pTNuybODz",
  "2iNbclOR": "zw6MWRiqb0",
  "101.111.180.186": "O2kGNIfudP",
  "6c2c493eea6045567a7fe783e16b784d723528c30e6": "JjAlsBLccF",
  "h101-111-180-186.hikari.itscom.jp": "Dj3J1KH748",
  "Chrome Mobile iOS 135.0.7049/iOS 18.5.0": "zyNZiL3TP5"
};

    // あなたの valueMap は「日本語 → 難読化済み」なので、逆マップには [難読化済み, 日本語] が必要！
    const reverseKeyMap = Object.fromEntries(Object.entries(keyMap).map(([k, v]) => [v, k]));
    const reverseValueMap = Object.fromEntries(Object.entries(valueMap).map(([original, obfuscated]) => [obfuscated, original]));
    function deobfuscate(obj) {
        if (typeof obj === 'string') {
            return reverseValueMap[obj] || obj;
        } else if (Array.isArray(obj)) {
            return obj.map(deobfuscate);
        } else if (typeof obj === 'object' && obj !== null) {
            const result = {};
            for (const [k, v] of Object.entries(obj)) {
                const originalKey = reverseKeyMap[k] || k;
                let value = v;

                // 🔍 追加: 値が文字列なら先に reverseValueMap を通してみる
                if (typeof value === 'string') {
                    value = reverseValueMap[value] || value;
                }

                result[originalKey] = deobfuscate(value);
            }
            return result;
        } else {
            return obj;
        }
    }

    let jsonData = null;

    async function fetchData() {
        const response = await fetch("./manifest/youchuuijinbutsulist.json");
        const obfuscated = await response.json();
        jsonData = deobfuscate(obfuscated);
    }

    async function searchUser() {
        if (!jsonData) {
            await fetchData();
        }

        console.log(jsonData["warning-list"]);
        console.log(jsonData);
        console.log("reverseKeyMap['2h83kF8lnj'] →", reverseKeyMap["2h83kF8lnj"]);
        console.log("復号した warning-list.keys()", Object.keys(jsonData["warning-list"]));

        const input = document.getElementById("searchInput").value.trim().toLowerCase();
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "";

        for (const category of ["warning-list", "danger-list", "super-danger-list", "blacklist", "hidden"]) {
            const list = jsonData[category];
            if (!list) continue;

            for (const key in list) {
                const person = list[key];
                if (person["username"] && person["username"].toLowerCase().includes(input)) {
                    const div = document.createElement("div");
                    div.innerHTML = `
                        <h3>カテゴリ: ${category}</h3>
                        <p>ユーザー名: ${person["username"] || "なし"}</p>
                        <p>フレンドコード: ${person["friend-code"] || "なし"}</p>
                        <p>メールアドレス: ${person["email"] || "なし"}</p>
                        <p>ネットワークID: ${person["network-id"] || "なし"}</p>
                        <p>ブラウザID: ${person["browser-id"] || "なし"}</p>
                        <p>理由: ${person["riyuu"] || "なし"}</p>
                        <p>対策: ${person["taisaku"] || "なし"}</p>
                    `;
                    resultDiv.appendChild(div);
                }
            }
        }
    }
