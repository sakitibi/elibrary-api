/* Minifyed by 13ninstudio, Inc */ const el=(e,t=document)=>t.querySelector(e),els=(e,t=document)=>Array.from(t.querySelectorAll(e)),kinds={text:{title:"テキスト",build:e=>{let t=e.text.value;const o=e.newline.value;return"before"===o&&(t="\n"+t),"after"===o&&(t+="\n"),{text:t}}},selector:{title:"セレクタ",build:e=>({selector:e.selector.value,...e.separator.value?{separator:e.separator.value}:{}})},score:{title:"スコア",build:e=>({score:{name:e.scoreName.value,objective:e.scoreObj.value}})},translate:{title:"翻訳キー",build:e=>{const t={translate:e.trKey.value},o=e.trWith.value.trim();if(o){const e=o.split(",").map((e=>e.trim())).filter(Boolean).map((e=>{try{return JSON.parse(e)}catch{return{text:e}}}));t.with=e}return t}},keybind:{title:"キーバインド",build:e=>({keybind:e.kbKey.value})}};function createComp(e="text"){const t=el("#tpl-comp").content.firstElementChild.cloneNode(!0),o=el("h3",t),l=el("select.kind",t),n={text:el('[data-for="text"]',t),selector:el('[data-for="selector"]',t),score:el('[data-for="score"]',t),translate:el('[data-for="translate"]',t),keybind:el('[data-for="keybind"]',t)},r={show_text:el('[data-hover="show_text"]',t),show_item:el('[data-hover="show_item"]',t),show_entity:el('[data-hover="show_entity"]',t)},a=e=>{Object.keys(n).forEach((t=>{n[t].classList.toggle("hidden",t!==e)})),o.textContent=kinds[e].title};return l.value=e,a(e),l.addEventListener("change",(()=>{a(l.value),refresh()})),el(".hoverAction",t).addEventListener("change",(e=>{var t;t=e.target.value||"none",Object.keys(r).forEach((e=>{r[e].classList.toggle("hidden",e!==t)})),refresh()})),el(".btn-del",t).addEventListener("click",(()=>{t.remove(),refresh()})),el(".btn-up",t).addEventListener("click",(()=>{const e=t.previousElementSibling;e&&e.before(t),refresh()})),el(".btn-down",t).addEventListener("click",(()=>{const e=t.nextElementSibling;e&&e.after(t),refresh()})),els("input,select,textarea",t).forEach((e=>e.addEventListener("input",refresh))),t}function readComp(e){const t=el(".kind",e).value,o=kinds[t],l={text:el(".text",e)||{value:""},newline:el(".newline",e)||{value:"no"},selector:el(".selector",e)||{value:""},separator:el(".separator",e)||{value:""},scoreName:el(".scoreName",e)||{value:""},scoreObj:el(".scoreObj",e)||{value:""},trKey:el(".trKey",e)||{value:""},trWith:el(".trWith",e)||{value:""},kbKey:el(".kbKey",e)||{value:""},colorPreset:el(".colorPreset",e),colorHex:el(".colorHex",e),fmts:els(".fmt",e),insertion:el(".insertion",e),clickAction:el(".clickAction",e),clickValue:el(".clickValue",e),hoverAction:el(".hoverAction",e),hoverText:el(".hoverText",e),hoverItemId:el(".hoverItemId",e),hoverItemCount:el(".hoverItemCount",e),hoverItemNbt:el(".hoverItemNbt",e),hoverEntityType:el(".hoverEntityType",e),hoverEntityId:el(".hoverEntityId",e),hoverEntityName:el(".hoverEntityName",e)};let n=o.build(l);const r=(l.colorHex.value||"").trim(),a=l.colorPreset.value;r?n.color=r:a&&(n.color=a),l.fmts.forEach((e=>{e.checked&&(n[e.dataset.k]=!0)})),l.insertion.value&&(n.insertion=l.insertion.value);const c=l.clickAction.value,i=l.clickValue.value.trim();c&&i&&(n.clickEvent={action:c,value:i});const s=l.hoverAction.value;if("show_text"===s&&l.hoverText.value&&(n.hoverEvent={action:"show_text",contents:{text:l.hoverText.value}}),"show_item"===s&&(l.hoverItemId.value||l.hoverItemNbt.value)){const e={id:l.hoverItemId.value||"minecraft:stone"},t=parseInt(l.hoverItemCount.value,10);!isNaN(t)&&t>0&&(e.count=t);const o=l.hoverItemNbt.value.trim();o&&(e.tag=o),n.hoverEvent={action:"show_item",contents:e}}if("show_entity"===s&&(l.hoverEntityType.value||l.hoverEntityId.value||l.hoverEntityName.value)){const e={};if(l.hoverEntityType.value&&(e.type=l.hoverEntityType.value),l.hoverEntityId.value&&(e.id=l.hoverEntityId.value),l.hoverEntityName.value){const t=l.hoverEntityName.value.trim();try{e.name=JSON.parse(t)}catch{e.name={text:t}}}n.hoverEvent={action:"show_entity",contents:e}}return n}function buildJson(){return els("#components > .comp").map(readComp)}function refresh(){const e=buildJson(),t=el("#target").value||"@a";el("#jsonOut").textContent=JSON.stringify(e,null,2),el("#cmdOut").textContent=`/tellraw ${t} `+JSON.stringify(e),localStorage.setItem("tellraw_state_1218",JSON.stringify({target:t,arr:e}))}function add(e="text"){const t=createComp(e);el("#components").appendChild(t),"text"===e&&(el(".text",t).value="テキスト"),"selector"===e&&(el(".selector",t).value="@p"),"score"===e&&(el(".scoreName",t).value="@p",el(".scoreObj",t).value="objective"),"translate"===e&&(el(".trKey",t).value="chat.type.text",el(".trWith",t).placeholder='{"text":"%s"}, {"text":"%s"}'),"keybind"===e&&(el(".kbKey",t).value="key.jump"),refresh()}function loadFromData(e){el("#components").innerHTML="",el("#target").value=e.target||"@a";(e.components||[]).forEach((e=>{let t="text";"selector"in e&&(t="selector"),"score"in e&&(t="score"),"translate"in e&&(t="translate"),"keybind"in e&&(t="keybind");const o=createComp(t);if(el("#components").appendChild(o),e.color&&(/^#([0-9a-fA-F]{6})$/.test(e.color)?el(".colorHex",o).value=e.color:el(".colorPreset",o).value=e.color),["bold","italic","underlined","strikethrough","obfuscated"].forEach((t=>{e[t]&&(el(`.fmt[data-k="${t}"]`,o).checked=!0)})),e.insertion&&(el(".insertion",o).value=e.insertion),e.clickEvent&&(el(".clickAction",o).value=e.clickEvent.action,el(".clickValue",o).value=e.clickEvent.value),e.hoverEvent){const t=e.hoverEvent.action;el(".hoverAction",o).value=t;const l=new Event("change");el(".hoverAction",o).dispatchEvent(l);const n=e.hoverEvent.contents;if("show_text"===t){const e=n&&(n.text||n)||"";el(".hoverText",o).value="string"==typeof e?e:JSON.stringify(n)}"show_item"===t&&(n?.id&&(el(".hoverItemId",o).value=n.id),n?.count&&(el(".hoverItemCount",o).value=n.count),n?.tag&&(el(".hoverItemNbt",o).value=n.tag)),"show_entity"===t&&(n?.type&&(el(".hoverEntityType",o).value=n.type),n?.id&&(el(".hoverEntityId",o).value=n.id),n?.name&&(el(".hoverEntityName",o).value="string"==typeof n.name?n.name:JSON.stringify(n.name)))}"text"===t&&(el(".text",o).value=e.text||""),"selector"===t&&(el(".selector",o).value=e.selector||"",e.separator&&(el(".separator",o).value=e.separator)),"score"===t&&(el(".scoreName",o).value=e.score?.name||"",el(".scoreObj",o).value=e.score?.objective||""),"translate"===t&&(el(".trKey",o).value=e.translate||"",Array.isArray(e.with)&&(el(".trWith",o).value=e.with.map((e=>"string"==typeof e?e:JSON.stringify(e))).join(", "))),"keybind"===t&&(el(".kbKey",o).value=e.keybind||"")})),refresh()}function toast(e,t=!1){const o=document.createElement("div");o.textContent=e,o.style.cssText=`position:fixed;bottom:18px;right:18px;background:${t?"#3a1620":"#143522"};border:1px solid ${t?"#ff6b6b":"#2ecc71"};padding:10px 14px;border-radius:12px;z-index:9999;opacity:.98`,document.body.appendChild(o),setTimeout((()=>o.remove()),1600)}el("#addText").addEventListener("click",(()=>add("text"))),el("#addSelector").addEventListener("click",(()=>add("selector"))),el("#addScore").addEventListener("click",(()=>add("score"))),el("#addTranslate").addEventListener("click",(()=>add("translate"))),el("#addKeybind").addEventListener("click",(()=>add("keybind"))),el("#copyCmd").addEventListener("click",(()=>{const e=el("#cmdOut").textContent;navigator.clipboard.writeText(e).then((()=>toast("コピーしました")))})),el("#copyJson").addEventListener("click",(()=>{const e=el("#jsonOut").textContent;navigator.clipboard.writeText(e).then((()=>toast("コピーしました")))})),el("#exportJson").addEventListener("click",(()=>{const e={target:el("#target").value,components:buildJson()},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(t),o.download="tellraw-1.21.8.json",o.click()})),el("#importJson").addEventListener("click",(()=>{const e=document.createElement("input");e.type="file",e.accept="application/json",e.onchange=()=>{const t=e.files[0];t&&t.text().then((e=>{try{loadFromData(JSON.parse(e))}catch{toast("JSONの読み込みに失敗",!0)}}))},e.click()})),el("#clearAll").addEventListener("click",(()=>{el("#components").innerHTML="",refresh()})),document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&refresh()}));try{const e=JSON.parse(localStorage.getItem("tellraw_state_1218")||"null");e?loadFromData({target:e.target,components:e.arr}):add("text")}catch{add("text")}refresh();
